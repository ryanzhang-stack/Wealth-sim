<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>äººç”Ÿä¼°å€¼æ²™ç›˜æ¨æ¼” | Khalidåœ¨è·¯ä¸Š</title>
    <meta name="description" content="æ‹’ç»çº¿æ€§æ€ç»´ï¼Œå¼€å¯ä¸Šå¸è§†è§’ã€‚ç”¨åŒ—å¤§é‡‘èæ¨¡å‹ï¼Œæ¨æ¼”ä½ æœªæ¥çš„æ— é™å¯èƒ½ã€‚">
    
    <meta property="og:title" content="äººç”Ÿä¼°å€¼æ²™ç›˜æ¨æ¼” | Khalidåœ¨è·¯ä¸Š">
    <meta property="og:description" content="ç®—ç®—ä½ çš„Offeræ½œåŠ›ï¼Œçœ‹çœ‹è¿˜è¦å¤šå°‘å¹´è´¢å¯Œè‡ªç”±ï¼Ÿç”¨é‡‘èæ€ç»´è§£æ„ä½ çš„äººç”Ÿã€‚">
    <meta property="og:image" content=""> 
    <meta property="og:url" content="https://fire-sandbox.top/">
    <meta property="og:type" content="website">

    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary-color: #8b5cf6;
            --primary-dark: #7c3aed;
            --accent-color: #f43f5e;
            --text-main: #1f2937;
            --text-light: #6b7280;
            --bg-gradient: linear-gradient(180deg, #fdf4ff 0%, #ffffff 100%);
            --card-bg: rgba(255, 255, 255, 0.98);
            --btn-gradient: linear-gradient(135deg, #8b5cf6 0%, #d946ef 100%);
            
            --input-bg: #f8fafc;
            --input-border: #e2e8f0;
            
            --result-gold: #fcd34d;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg-gradient); color: var(--text-main); margin: 0; padding: 15px 12px;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
        }

        .container {
            background: var(--card-bg); width: 100%; max-width: 800px; padding: 20px 18px;
            border-radius: 24px; box-shadow: 0 10px 40px -10px rgba(139, 92, 246, 0.15); margin-bottom: 20px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.8); transition: all 0.3s ease;
        }
        
        /* Hero */
        .hero-card {
            background: white; border: 1px solid rgba(139,92,246,0.15); 
            border-radius: 16px; padding: 15px; margin-bottom: 10px; 
            box-shadow: 0 4px 15px rgba(139,92,246,0.03); text-align: center;
        }
        .emoji-header { font-size: 28px; margin-bottom: 2px; display: block; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-4px); } 100% { transform: translateY(0px); } }
        h1 { 
            font-size: 20px; margin: 0 0 12px 0; color: #4c1d95; font-weight: 800; 
            background: -webkit-linear-gradient(45deg, #8b5cf6, #f43f5e);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .intro-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-bottom: 12px; }
        .intro-card { background: #f9fafb; border-radius: 8px; padding: 8px 6px; text-align: left; }
        .ic-title { font-size: 12px; font-weight: 700; color: #7c3aed; margin-bottom: 2px; display: flex; align-items: center; gap: 3px; }
        .ic-text { font-size: 10px; color: #4b5563; line-height: 1.3; opacity: 0.9; }

        .guide-step { display: flex; flex-direction: column; align-items: center; gap: 3px; flex: 1; text-align: center; }
        .guide-icon { font-size: 14px; background: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid #f3f4f6; }
        .guide-text { font-size: 10px; color: #5b21b6; font-weight: 700; }
        .guide-line { width: 15px; height: 1px; background: #ddd6fe; }

        .scroll-hint { text-align: center; margin-bottom: 10px; animation: bounce 2s infinite; opacity: 0.6; }
        .scroll-hint span { font-size: 18px; color: #8b5cf6; cursor: pointer; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-4px);} 60% {transform: translateY(-2px);} }

        /* Controls - ä¿®å¤å¯¹é½ */
        .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .section-label { font-size: 15px; font-weight: 700; color: #4b5563; display: flex; align-items: center; gap: 6px; line-height: 1; }
        
        /* ä¿®å¤ Pro æŒ‰é’®å¯¹é½çš„æ ¸å¿ƒä»£ç  */
        .mode-switch { 
            position: relative; width: 130px; height: 36px; background: #f3f4f6; 
            border-radius: 18px; display: flex; align-items: center; padding: 3px; 
            cursor: pointer; user-select: none; box-sizing: border-box;
        }
        .switch-slider { 
            position: absolute; left: 3px; top: 3px; width: 62px; height: 30px; 
            background: white; border-radius: 15px; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.1); transition: transform 0.3s; z-index: 1; 
        }
        .mode-label { 
            flex: 1; text-align: center; font-size: 12px; font-weight: 700; color: #9ca3af; 
            z-index: 2; transition: color 0.3s; 
            line-height: 30px; /* å…³é”®ä¿®å¤ï¼šä¸æ»‘å—é«˜åº¦ä¸€è‡´ */
            display: flex; align-items: center; justify-content: center; /* ç¡®ä¿æ–‡å­—ç»å¯¹å±…ä¸­ */
        }
        .container.pro-mode .switch-slider { transform: translateX(62px); background: linear-gradient(135deg, #8b5cf6, #a78bfa); }
        .container.pro-mode .mode-label.pro-text { color: white; }

        .tabs { display: flex; margin-bottom: 15px; background: #f9fafb; border-radius: 14px; padding: 3px; gap: 3px; border: 1px solid #f3f4f6; }
        .tab { flex: 1; text-align: center; padding: 8px 2px; cursor: pointer; border-radius: 12px; transition: all 0.2s; color: #6b7280; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .tab-title { font-size: 13px; font-weight: 700; line-height: 1.2; }
        .tab-desc { font-size: 9px; font-weight: 400; opacity: 0.8; margin-top: 2px; transform: scale(0.95); white-space: nowrap; }
        .tab.active { background: white; color: var(--primary-color); box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
        .container.pro-mode .tab.active { color: #7c3aed; }

        .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        @media (max-width: 700px) { .main-grid { grid-template-columns: 1fr; gap: 10px; } }
        
        .section-title { font-size: 14px; font-weight: 700; color: #6b7280; margin-bottom: 8px; border-bottom: 2px solid #f3f4f6; padding-bottom: 4px; display: flex; justify-content: space-between; }
        .form-group { margin-bottom: 10px; border-radius: 12px; padding: 4px; border: 2px solid transparent; }
        label { display: flex; align-items: center; justify-content: space-between; font-size: 13px; color: #4b5563; margin-bottom: 4px; font-weight: 600; }
        
        .form-group.target-highlight { background-color: var(--result-bg) !important; border-color: var(--result-border) !important; animation: breathe 3s infinite ease-in-out; }
        @keyframes breathe { 0%, 100% { border-color: rgba(244, 63, 94, 0.5); } 50% { border-color: rgba(244, 63, 94, 1); } }
        .form-group.target-highlight label { color: #be123c !important; }
        .form-group.target-highlight label::after { content: "âœ¨ æ™ºèƒ½è®¡ç®—"; font-size: 10px; background: white; color: #be123c; padding: 2px 6px; border-radius: 10px; border: 1px solid #fecdd3; }

        input { width: 100%; padding: 10px; border: 2px solid #f3f4f6; border-radius: 10px; font-size: 16px; box-sizing: border-box; background: var(--input-bg); color: #1f2937; }
        input[type="text"] { input-mode: decimal; } 
        input:focus { outline: none; border-color: #a78bfa; background: white; }
        
        .form-group.target-highlight input { background-color: transparent !important; border: none !important; border-bottom: 2px dashed rgba(244, 63, 94, 0.3) !important; color: #be123c !important; font-weight: 800 !important; font-size: 22px !important; text-align: center !important; }

        .pro-only { display: none; }
        .container.pro-mode .pro-only { display: block; animation: slideDown 0.4s ease; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        .growth-inputs { background: #fff1f2; padding: 10px; border-radius: 12px; border: 1px solid #ffe4e6; margin-bottom: 10px; }
        .container.pro-mode .growth-inputs { background: #f5f3ff; border-color: #ddd6fe; }
        
        .event-row { display: flex; gap: 6px; margin-bottom: 8px; align-items: center; }
        .btn-add { background: white; border: 2px dashed #d1d5db; color: #6b7280; width: 100%; padding: 10px; border-radius: 12px; cursor: pointer; font-size: 12px; font-weight: 600; }
        .btn-del { border:none; background:white; color:#ef4444; width:24px; height:24px; border-radius:50%; box-shadow:0 2px 4px rgba(0,0,0,0.1); cursor:pointer; display:flex; align-items:center; justify-content:center; }

        #lite-placeholder { text-align: center; padding: 10px; border: 1px dashed #d1d5db; border-radius: 12px; background: #f9fafb; display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 15px; color: #9ca3af; cursor: pointer; }

        .btn-calc { width: 100%; background: linear-gradient(135deg, #8b5cf6 0%, #d946ef 100%); color: white; padding: 14px; border: none; border-radius: 16px; font-size: 16px; font-weight: 700; cursor: pointer; margin-top: 5px; margin-bottom: 10px; box-shadow: 0 8px 20px -5px rgba(139, 92, 246, 0.4); transition: transform 0.1s; }
        .btn-calc:active { transform: scale(0.98); }

        /* ğŸ”¥ V49.0 ç»“æœé¢æ¿ï¼šä¸¥æ ¼æŒ‰ç…§å‚è€ƒå›¾å·¦å³åˆ†å‰² */
        .result-panel { 
            background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%); 
            color: white; padding: 20px 15px; 
            border-radius: 20px; margin-top: 15px; 
            display: grid; 
            grid-template-columns: 1fr 1px 1fr; /* å·¦ å†…å®¹ å³ */
            gap: 10px;
            position: relative; overflow: hidden;
            box-shadow: 0 10px 25px -5px rgba(124, 58, 237, 0.4);
        }
        
        /* è£…é¥°ç”¨æ–œå…‰ï¼ˆå‚è€ƒå›¾æ•ˆæœï¼‰ */
        .result-panel::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
            transform: rotate(30deg); pointer-events: none;
        }

        /* å‚ç›´åˆ†å‰²çº¿ */
        .res-divider { background: rgba(255,255,255,0.2); width: 1px; height: 100%; }

        /* é€šç”¨åˆ—æ ·å¼ */
        .res-col {
            display: flex; flex-direction: column; align-items: center; justify-content: space-between; text-align: center; height: 100%; min-height: 120px;
        }

        /* å·¦åˆ—ï¼šåä¹‰ + äºŒç»´ç  */
        .res-label-main { color: rgba(255,255,255,0.9); font-size: 11px; margin-bottom: 4px; }
        .res-value-main { font-size: 26px; font-weight: 800; line-height: 1.1; word-break: break-all; color: var(--result-gold); text-shadow: 0 2px 10px rgba(253, 230, 138, 0.2); margin-bottom: 8px; }
        
        /* å³åˆ—ï¼šå®é™… + æŒ‰é’® */
        .res-label-sub { color: rgba(255,255,255,0.8); font-size: 11px; margin-bottom: 4px; }
        .res-value-sub { font-size: 22px; font-weight: 700; color: white; word-break: break-all; margin-bottom: 8px; }

        /* V49.0 äºŒç»´ç ï¼šçœŸæ­£èå…¥èƒŒæ™¯çš„çº¯ç™½å°èŠ± */
        .qr-blended {
            width: 55px; height: 55px;
            /* æ ¸å¿ƒï¼šåè½¬é¢œè‰²+æ»¤è‰²æ··åˆ = çº¯ç™½é€æ˜ */
            filter: invert(1) !important;
            mix-blend-mode: screen !important;
            opacity: 0.85;
            display: block; margin-top: auto; /* æ¨åˆ°åº•éƒ¨ */
        }
        .qr-hint { font-size: 9px; color: rgba(255,255,255,0.6); margin-top: 2px; }

        /* æŒ‰é’®ç»„ */
        .cpi-control-box {
            background: rgba(255,255,255,0.15); border-radius: 12px; padding: 2px; 
            display: flex; margin-top: auto; /* æ¨åˆ°åº•éƒ¨ */
        }
        .cpi-btn { background: transparent; border: none; color: rgba(255,255,255,0.7); font-size: 9px; padding: 4px 8px; cursor: pointer; border-radius: 10px; font-weight: 600; }
        .cpi-btn.active { background: rgba(255,255,255,0.95); color: #7c3aed; }

        .achievement-box { background: #fffbeb; border: 1px solid #fcd34d; border-left: 4px solid #f59e0b; padding: 15px; margin-top: 20px; border-radius: 12px; display: none; position: relative; overflow: hidden; }
        .achievement-box::after { content: 'ğŸ†'; position: absolute; right: -10px; bottom: -10px; font-size: 80px; opacity: 0.1; transform: rotate(-20deg); }
        .achievement-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .achievement-badge { background: #f59e0b; color: white; font-size: 11px; font-weight: 700; padding: 4px 10px; border-radius: 12px; }
        .achievement-title { font-size: 16px; font-weight: 800; color: #92400e; }
        .achievement-text { font-size: 13px; color: #b45309; line-height: 1.5; }
        
        .chart-box { margin-top: 25px; height: 250px; position: relative; min-height: 250px; }

        .glossary-box { margin-top: 25px; border-top: 1px dashed #e5e7eb; padding-top: 15px; }
        .glossary-summary { font-size: 13px; font-weight: 700; color: #6b7280; cursor: pointer; padding: 10px; background: #f9fafb; border-radius: 10px; list-style: none; display: flex; justify-content: space-between; align-items: center; }
        .glossary-content { padding-top: 15px; animation: fadeIn 0.5s; }
        .glossary-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .glossary-item { font-size: 12px; color: #6b7280; line-height: 1.5; background: #f9fafb; padding: 10px; border-radius: 10px; }
        .glossary-item b { color: var(--primary-dark); display: block; margin-bottom: 2px; }
        .ref-val { color: #f43f5e; font-size: 11px; display: block; margin-top: 4px; font-weight: 500; }

        .wealth-section { width: 100%; box-sizing: border-box; background: #f9fafb; padding: 12px; border-radius: 12px; }
        .wealth-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px; width: 100%; }
        .wealth-card { padding: 10px; border-radius: 10px; background: rgba(139,92,246,0.03); border: 1px solid rgba(139,92,246,0.1); display: flex; flex-direction: column; justify-content: space-between; }
        .wealth-level { font-weight: 800; color: #7c3aed; font-size: 12px; margin-bottom: 4px; border-bottom: 1px dashed rgba(139,92,246,0.2); padding-bottom: 4px; display: block; }
        .wealth-data { font-size: 11px; color: #4b5563; line-height: 1.5; }

        .action-bar { margin-top: 25px; display: flex; justify-content: center; gap: 10px; }
        .btn-reset { background: white; border: 1px solid #e5e7eb; color: #94a3b8; font-size: 13px; padding: 10px 20px; border-radius: 20px; cursor: pointer; transition: all 0.2s; }
        .btn-share-hero { background: #1f2937; color: white; border: none; font-size: 13px; font-weight: 600; padding: 10px 20px; border-radius: 20px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 6px; transition: transform 0.2s; }

        .xhs-promo-card { margin-top: 30px; padding: 20px; background: #ffffff; border-radius: 20px; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.05); border: 1px solid rgba(0, 0, 0, 0.03); text-align: center; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; }
        .xhs-promo-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 6px; background: #ff2442; }
        .promo-avatar { font-size: 36px; margin-top: 5px; margin-bottom: 8px; width: 50px; height: 50px; background: #fff5f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid #ff2442; }
        .promo-header { font-size: 15px; color: #1f2937; font-weight: 800; margin-bottom: 6px; }
        .promo-header span { color: #ff2442; }
        .promo-tags { font-size: 12px; color: #6b7280; line-height: 1.6; margin-bottom: 15px; max-width: 95%; }
        .promo-btn { width: 100%; max-width: 220px; background: #ff2442; color: white; text-decoration: none; padding: 10px 0; border-radius: 30px; font-size: 13px; font-weight: 700; box-shadow: 0 4px 15px rgba(255, 36, 66, 0.3); transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 6px; }

        .footer-legal { text-align: center; margin-top: 30px; padding-bottom: 30px; color: #9ca3af; }
        .footer-legal p { margin: 4px 0; font-size: 11px; }
        .footer-legal a { color: var(--primary-color); text-decoration: none; border-bottom: 1px dashed #cbd5e1; }
        .disclaimer { opacity: 0.6; font-size: 10px !important; margin-top: 10px !important; transform: scale(0.95); }
    </style>
</head>
<body>

<div class="container" id="appContainer">
    <div class="hero-card">
        <span class="emoji-header">ğŸ”®</span>
        <h1>äººç”Ÿä¼°å€¼æ²™ç›˜æ¨æ¼”</h1>
        <div class="intro-grid">
            <div class="intro-card"><div class="ic-title">ğŸ“ Offeré€‰æ‹©</div><div class="ic-text">ä¸åŒçš„è½¨é“ï¼Œä¸åŒçš„äººç”Ÿä¼°å€¼æ›²çº¿ï¼Ÿ</div></div>
            <div class="intro-card"><div class="ic-title">ğŸŒ± ç†è´¢åˆå°</div><div class="ic-text">è¿˜è¦å¤šå°‘å¹´æ‰èƒ½è´¢å¯Œè‡ªç”±ï¼Ÿ</div></div>
            <div class="intro-card"><div class="ic-title">â° æ‰“å·¥é¸¡æ±¤</div><div class="ic-text">åˆ«é«˜ä¼°1ä¸ªæœˆçš„åŠªåŠ›ï¼Œä½ä¼°10å¹´çš„å¤åˆ©ã€‚</div></div>
            <div class="intro-card"><div class="ic-title">ğŸ“ˆ æŠ•èµ„ç­–ç•¥</div><div class="ic-text">å¦‚ä½•é”šå®šåˆé€‚çš„å¹´åŒ–æ”¶ç›Šç‡åŒºé—´ï¼Ÿ</div></div>
        </div>
        <div style="height:1px; background:#f3f4f6; margin:10px 0; width:100%;"></div>
        <div style="display:flex; justify-content:space-between; align-items:center; padding:0 5px;">
            <div class="guide-step"><div class="guide-icon">ğŸ¯</div><div class="guide-text">è®¾å®šç›®æ ‡</div></div>
            <div class="guide-line"></div>
            <div class="guide-step"><div class="guide-icon">ğŸ“</div><div class="guide-text">è¾“å…¥æ•°å­—</div></div>
            <div class="guide-line"></div>
            <div class="guide-step"><div class="guide-icon">ğŸ”“</div><div class="guide-text">è§£é”ä¼°å€¼</div></div>
        </div>
    </div>

    <div class="scroll-hint"><span>ğŸ‘‡</span></div>

    <div class="header-row">
        <span class="section-label">âœ¨ æ¨æ¼”æ¨¡å¼</span>
        <div class="mode-switch" onclick="toggleMode()">
            <div class="switch-slider"></div>
            <div class="mode-label">å°ç™½æ¨¡å¼</div>
            <div class="mode-label pro-text">Pro ä¸“å®¶</div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" data-target="fv" onclick="switchTab('fv')">
            <span class="tab-title">ç®—å­˜æ¬¾</span>
            <span class="tab-desc">æœªæ¥æœ‰å¤šå°‘é’±</span>
        </div>
        <div class="tab" data-target="pmt" onclick="switchTab('pmt')">
            <span class="tab-title">ç®—æŠ•å…¥</span>
            <span class="tab-desc">æ¯æœˆè¦å­˜å¤šå°‘</span>
        </div>
        <div class="tab" data-target="pv" onclick="switchTab('pv')">
            <span class="tab-title">ç®—æœ¬é‡‘</span>
            <span class="tab-desc">ç°åœ¨è¦æœ‰å‡ ä¸‡</span>
        </div>
        <div class="tab" data-target="years" onclick="switchTab('years')">
            <span class="tab-title">ç®—æ—¶é—´</span>
            <span class="tab-desc">è¿˜è¦å¥‹æ–—å¤šä¹…</span>
        </div>
    </div>

    <div class="main-grid">
        <div>
            <div class="section-title">ğŸ“Š åŸºç¡€å‚æ•°</div>
            <div class="form-group" id="grp_pv"><label>ğŸ’° ç°æœ‰èµ„é‡‘ (æœ¬é‡‘)</label><input type="number" inputmode="decimal" id="pv" placeholder="100000"></div>
            <div class="form-group" id="grp_fv"><label>ğŸ ç›®æ ‡é‡‘é¢</label><input type="number" inputmode="decimal" id="target_fv" placeholder="20000000"></div>
            <div id="simple_pmt_box" class="form-group" id="grp_simple_pmt"><label>ğŸ“¥ æ¯æœˆèƒ½å­˜å¤šå°‘é’±</label><input type="number" inputmode="decimal" id="simple_pmt" placeholder="2000"></div>
            <div id="pro_cashflow_box" style="display:none;">
                <div class="form-group"><label style="color:var(--primary-color)">ğŸ’µ æœˆæ”¶å…¥ (ç¨å)</label><input type="number" inputmode="decimal" id="income" placeholder="3000"></div>
                <div class="form-group"><label style="color:var(--accent-color)">ğŸ’¸ æœˆæ”¯å‡º (å¼€é”€)</label><input type="number" inputmode="decimal" id="expense" placeholder="1000"></div>
            </div>
            <div class="form-group" id="grp_solved_pmt" style="display:none;"><label>ğŸ‘‰ å»ºè®®æ¯æœˆå­˜å…¥</label><input type="text" id="solved_pmt" value="âœ¨ å¾…è®¡ç®—..." disabled></div>
            <div class="form-group"><label>ğŸ“ˆ å¹´åŒ–ç†è´¢æ”¶ç›Š (%)</label><input type="number" inputmode="decimal" id="rate" placeholder="5"></div>
            <div class="form-group" id="grp_years"><label>â³ å¥‹æ–—æ—¶é•¿ (å¹´)</label><input type="number" inputmode="decimal" id="years" placeholder="15"></div>
        </div>
        <div class="pro-only">
            <div class="section-title">ğŸš€ åŠ¨æ€å¢é•¿ (Pro)</div>
            <div class="growth-inputs">
                <div class="form-group"><label style="color:var(--primary-color)">ğŸš€ å·¥èµ„å¹´æ¶¨å¹… (%)</label><input type="number" inputmode="decimal" id="inc_growth" placeholder="10"></div>
                <div class="form-group"><label style="color:var(--accent-color)">ğŸ¥¬ å¼€é”€æ¶¨å¹… (%)</label><input type="number" inputmode="decimal" id="exp_growth" placeholder="3"></div>
            </div>
            <div class="section-title">ğŸš© äººç”Ÿå¤§é¢æ”¶æ”¯</div>
            <div id="eventContainer" class="event-list"></div>
            <button class="btn-add" onclick="addEventRow()">+ æ·»åŠ èŠ‚ç‚¹ (å¦‚: è´­è½¦/ç¤¼ç‰©/å‰¯ä¸š)</button>
        </div>
        
        <div id="lite-placeholder" onclick="toggleMode()">
            <span style="font-size:20px;">ğŸ¦„</span>
            <span style="font-size:12px; font-weight:600;">ç‚¹å‡»å¼€å¯ Pro æ¨¡å¼ (å·¥èµ„æ¶¨å¹…/å¤§é¢æ”¶æ”¯)</span>
        </div>
    </div>

    <button class="btn-calc" onclick="runCalculation()">å¼€å§‹æ¨æ¼”æœªæ¥</button>

    <div class="result-panel">
        <div class="res-col">
            <div>
                <label class="res-label-main">æœŸæœ«åä¹‰èµ„äº§ (è´¦é¢)</label>
                <div class="res-value-main" id="resValue1">--</div>
            </div>
            <div style="display:flex; flex-direction:column; align-items:center;">
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://fire-sandbox.top/&v=3" class="qr-blended" alt="æ‰«ç ">
                <span class="qr-hint">æ‰«ç åˆ†äº«</span>
            </div>
        </div>

        <div class="res-divider"></div>

        <div class="res-col">
            <div>
                <label class="res-label-sub">å®é™…è´­ä¹°åŠ› (æŠ˜ç°)</label>
                <div class="res-value-sub" id="resValue2">--</div>
            </div>
            <div class="cpi-control-box">
                <button class="cpi-btn low active" id="cpiLow" onclick="setCPI(0.5, 'low')">ä½0.5%</button>
                <button class="cpi-btn med" id="cpiMed" onclick="setCPI(2.5, 'med')">ä¸­2.5%</button>
                <button class="cpi-btn high" id="cpiHigh" onclick="setCPI(5.0, 'high')">é«˜5.0%</button>
            </div>
        </div>
    </div>

    <div class="achievement-box" id="achievementBox">
        <div class="achievement-header"><div class="achievement-badge">ğŸ† è§£é”æˆå°±</div><div class="achievement-title" id="achTitle">--</div></div>
        <div class="achievement-text" id="achText">è¯·è¿›è¡Œè®¡ç®—...</div>
    </div>

    <div class="chart-box"><canvas id="simChart"></canvas></div>
    
    <details class="glossary-box">
        <summary class="glossary-summary">ğŸ“– æŸ¥çœ‹ï¼šæŒ‡æ ‡å«ä¹‰ & è´¢å¯Œè‡ªç”±é—¨æ§› (èƒ¡æ¶¦)</summary>
        <div class="glossary-content">
            <div class="glossary-grid">
                <div class="glossary-item"><b>å¹´åŒ–æ”¶ç›Š (%)</b>ç†è´¢äº§å“çš„å¹³å‡å¹´å›æŠ¥ç‡ã€‚<span class="ref-val">å‚è€ƒ: ä½™é¢å®~1-2%, å€ºåˆ¸åŸºé‡‘~2-4%</span></div>
                <div class="glossary-item"><b>å·¥èµ„å¹´æ¶¨å¹… (%)</b>Proæ¨¡å¼ä¸‹ï¼Œæ¯å¹´è–ªèµ„å¢é•¿çš„é€Ÿåº¦ã€‚<span class="ref-val">å‚è€ƒ: èŒåœºåˆæœŸ~10-20%, ç¨³å®šæœŸ~3-5%</span></div>
                <div class="glossary-item"><b>å¼€é”€æ¶¨å¹… (%)</b>ç”Ÿæ´»æˆæœ¬æå‡é€Ÿåº¦ (å«é€šèƒ€+æ¶ˆè´¹å‡çº§)ã€‚<span class="ref-val">å‚è€ƒ: 3% (ä¿å®ˆ), 5% (é«˜é€šèƒ€)</span></div>
                <div class="glossary-item"><b>å®é™…è´­ä¹°åŠ›</b>æ‰£é™¤é€šèƒ€åï¼Œè¿™ç¬”é’±ç›¸å½“äºä»Šå¤©çš„ä»·å€¼ã€‚<span class="ref-val">é€»è¾‘: é¿å…"è´§å¸å¹»è§‰"ï¼Œåæ˜ çœŸå®ç”Ÿæ´»æ°´å¹³</span></div>
            </div>
            <div class="wealth-section">
                <b style="color:#374151; font-size:13px;">ğŸ† è´¢å¯Œè‡ªç”±é—¨æ§› (èƒ¡æ¶¦2021)</b>
                <div class="wealth-grid">
                    <div class="wealth-card"><span class="wealth-level">ğŸŸ¢ å…¥é—¨çº§</span><div class="wealth-data">ä¸€çº¿: 1900ä¸‡<br>äºŒçº¿: 1200ä¸‡<br>ä¸‰çº¿: 600ä¸‡</div></div>
                    <div class="wealth-card"><span class="wealth-level">ğŸ”µ ä¸­çº§</span><div class="wealth-data">ä¸€çº¿: 6500ä¸‡<br>äºŒçº¿: 4100ä¸‡<br>ä¸‰çº¿: 1500ä¸‡</div></div>
                    <div class="wealth-card"><span class="wealth-level">ğŸŸ£ é«˜çº§</span><div class="wealth-data">ä¸€çº¿: 1.9äº¿<br>äºŒçº¿: 1.2äº¿<br>ä¸‰çº¿: 6900ä¸‡</div></div>
                    <div class="wealth-card" style="border-color: #f59e0b; background: rgba(245,158,11,0.05);"><span class="wealth-level" style="color:#d97706">ğŸ‘‘ å›½é™…çº§</span><div class="wealth-data">å…¨çƒ: 3.5äº¿<br>(é¡¶å³°ç›®æ ‡)</div></div>
                </div>
            </div>
        </div>
    </details>

    <div class="action-bar">
        <button class="btn-reset" onclick="clearData()">ğŸ—‘ï¸ é‡ç½®</button>
        <button class="btn-share-hero" onclick="copyReport()">ğŸ“‹ å¤åˆ¶è¯¦ç»†æˆå°±æˆ˜æŠ¥</button>
    </div>

    <div class="xhs-promo-card">
        <div class="promo-avatar">ğŸ¦</div>
        <div class="promo-header">Designed by <span>Khalidåœ¨è·¯ä¸Š</span></div>
        <div class="promo-tags">ä¸€ä¸ªè„‘æ´å¾ˆå¤§çš„è·¨å¢ƒé‡‘èä»ä¸šè€…<br>åˆ†äº«å®è§‚è§†è§’ä¸‹çš„ä¸ªäººæˆé•¿ä¸æ€è€ƒåæ§½</div>
        <a href="https://www.xiaohongshu.com/user/profile/57d207127fc5b80a5ba8f181?xsec_token=ABV1YdZWooJGuigvNywrRlCN8Pu00zWLQwV21BWFv07Qk%3D&xsec_source=pc_search" target="_blank" class="promo-btn">ğŸš€ ç‚¹å‡»å‰å¾€å°çº¢ä¹¦ä¸»é¡µ</a>
    </div>
</div>

<div class="footer-legal">
    <p>Â© 2026 Khalidåœ¨è·¯ä¸Š. All Rights Reserved.</p>
    <p>è”ç³»é‚®ç®±: <a href="mailto:ryan.zhang@pku.org.cn">ryan.zhang@pku.org.cn</a></p>
    <p class="disclaimer">âš ï¸ å£°æ˜ï¼šæœ¬å·¥å…·ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚</p>
</div>

<script>
    let chartInstance = null;
    let currentTab = 'fv';
    let isProMode = false;
    let currentCPI = 0.5; 
    let currentCPILevel = 'low';
    let lastResult = { val: 0, realVal: 0, years: 10, inputs: {}, achTitle: "", achText: "" };

    const DEFAULTS = {
        pv: 100000, target_fv: 20000000, simple_pmt: 2000,
        income: 3000, expense: 1000, rate: 5, years: 15, inc_growth: 10, exp_growth: 3, cpi: 0.5
    };

    function safeGetEl(id) { return document.getElementById(id); }
    function getVal(id, defKey) { 
        const el = safeGetEl(id);
        if(!el) return DEFAULTS[defKey];
        return el.value === "" ? DEFAULTS[defKey] : parseFloat(el.value);
    }
    function getRawVal(id) { 
        const el = safeGetEl(id);
        if(!el) return DEFAULTS[id];
        return el.value === "" ? DEFAULTS[id] : el.value;
    }

    window.onload = function() {
        try { loadData(); } catch(e) { console.error(e); clearData(false); }
    };

    function setCPI(val, level) {
        currentCPI = val;
        currentCPILevel = level;
        document.querySelectorAll('.cpi-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById('cpi' + level.charAt(0).toUpperCase() + level.slice(1)).classList.add('active');
        if (lastResult.val > 0 || lastResult.val < 0) { runCalculation(); }
    }

    function saveData() {
        try {
            const data = {
                pv: safeGetEl('pv').value, target_fv: safeGetEl('target_fv').value,
                simple_pmt: safeGetEl('simple_pmt').value, income: safeGetEl('income').value,
                expense: safeGetEl('expense').value, rate: safeGetEl('rate').value,
                years: safeGetEl('years').value, inc_growth: safeGetEl('inc_growth').value,
                exp_growth: safeGetEl('exp_growth').value, isProMode: isProMode,
                cpi: currentCPI, cpiLevel: currentCPILevel, events: []
            };
            const rows = document.querySelectorAll('.event-row');
            rows.forEach(row => {
                data.events.push({
                    y: row.querySelector('.event-year').value,
                    desc: row.querySelector('.event-desc').value,
                    amt: row.querySelector('.event-amount').value
                });
            });
            localStorage.setItem('wealth_sim_v49', JSON.stringify(data));
        } catch(e) {}
    }

    function loadData() {
        const saved = localStorage.getItem('wealth_sim_v49');
        if (!saved) { updateUI(); return; }
        
        const data = JSON.parse(saved);
        const fields = ['pv', 'target_fv', 'simple_pmt', 'income', 'expense', 'rate', 'years', 'inc_growth', 'exp_growth'];
        fields.forEach(id => {
            if(safeGetEl(id)) safeGetEl(id).value = data[id] || "";
        });

        if (data.isProMode) {
            isProMode = true;
            safeGetEl('appContainer').classList.add('pro-mode');
            safeGetEl('lite-placeholder').style.display = 'none';
        }
        
        if(data.cpi) {
            currentCPI = data.cpi;
            currentCPILevel = data.cpiLevel || 'low';
            setCPI(currentCPI, currentCPILevel);
        }
        
        if (data.events && data.events.length > 0) {
            data.events.forEach(e => addEventRow(e.y, e.desc, e.amt));
        }
        updateUI();
    }

    function clearData(ask=true) {
        if(ask && !confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿ')) return;
        localStorage.removeItem('wealth_sim_v49');
        const inputs = document.querySelectorAll('input');
        inputs.forEach(i => i.value = "");
        document.getElementById('eventContainer').innerHTML = "";
        isProMode = false;
        safeGetEl('appContainer').classList.remove('pro-mode');
        setCPI(0.5, 'low');
        updateUI();
    }

    function toggleMode() {
        isProMode = !isProMode;
        const container = safeGetEl('appContainer');
        const ph = safeGetEl('lite-placeholder');
        if (isProMode) { container.classList.add('pro-mode'); ph.style.display = 'none'; } 
        else { container.classList.remove('pro-mode'); ph.style.display = 'flex'; }
        updateUI(); saveData();
    }

    function switchTab(tab) {
        currentTab = tab;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelector(`.tab[data-target="${tab}"]`).classList.add('active');
        updateUI();
    }

    function setAsTarget(el) {
        el.type = 'text'; 
        el.value = 'âœ¨ å¾…è®¡ç®—...'; 
        el.disabled = true;
        el.closest('.form-group').classList.add('target-highlight');
    }

    function setAsInput(el, defaultVal) {
        el.type = 'number';
        el.disabled = false;
        el.closest('.form-group').classList.remove('target-highlight');
        el.closest('.form-group').classList.add('input-needed');
        if (el.value === 'âœ¨ å¾…è®¡ç®—...' || el.value === '') {
            el.value = defaultVal; 
        }
    }

    function updateUI() {
        const els = {
            pv: safeGetEl('pv'), 
            fv: safeGetEl('target_fv'), 
            years: safeGetEl('years'),
            rate: safeGetEl('rate'),
            simple: safeGetEl('simple_pmt_box'), 
            pro: safeGetEl('pro_cashflow_box'),
            res: safeGetEl('grp_solved_pmt')
        };

        document.querySelectorAll('.form-group').forEach(el => {
            el.classList.remove('target-highlight', 'input-needed');
        });

        if (currentTab === 'pmt') {
            els.simple.style.display = 'none'; els.pro.style.display = 'none'; els.res.style.display = 'block';
            setAsTarget(safeGetEl('solved_pmt'));
        } else {
            els.res.style.display = 'none';
            if (isProMode) { els.simple.style.display = 'none'; els.pro.style.display = 'block'; } 
            else { els.simple.style.display = 'block'; els.pro.style.display = 'none'; }
        }

        setAsInput(els.rate, DEFAULTS.rate);

        if (currentTab === 'fv') { 
            setAsTarget(els.fv); 
            setAsInput(els.pv, DEFAULTS.pv);
            setAsInput(els.years, DEFAULTS.years);
            if (!isProMode) {
                setAsInput(safeGetEl('simple_pmt'), DEFAULTS.simple_pmt);
            } else {
                setAsInput(safeGetEl('income'), DEFAULTS.income);
                setAsInput(safeGetEl('expense'), DEFAULTS.expense);
            }
        } 
        else if (currentTab === 'pv') { 
            setAsTarget(els.pv); 
            setAsInput(els.fv, DEFAULTS.target_fv);
            setAsInput(els.years, DEFAULTS.years);
            if (!isProMode) {
                setAsInput(safeGetEl('simple_pmt'), DEFAULTS.simple_pmt);
            } else {
                setAsInput(safeGetEl('income'), DEFAULTS.income);
                setAsInput(safeGetEl('expense'), DEFAULTS.expense);
            }
        } 
        else if (currentTab === 'years') { 
            setAsTarget(els.years); 
            setAsInput(els.pv, DEFAULTS.pv);
            setAsInput(els.fv, DEFAULTS.target_fv);
            if (!isProMode) {
                setAsInput(safeGetEl('simple_pmt'), DEFAULTS.simple_pmt);
            } else {
                setAsInput(safeGetEl('income'), DEFAULTS.income);
                setAsInput(safeGetEl('expense'), DEFAULTS.expense);
            }
        } 
        else if (currentTab === 'pmt') {
            setAsInput(els.pv, DEFAULTS.pv);
            setAsInput(els.fv, DEFAULTS.target_fv);
            setAsInput(els.years, DEFAULTS.years);
        }
        
        safeGetEl('achievementBox').style.display = 'none';
    }

    function addEventRow(y="", desc="", amt="") {
        const div = document.createElement('div');
        div.className = 'event-row';
        div.innerHTML = `
            <input type="number" class="event-year" placeholder="å¹´" value="${y}" style="width:50px" onchange="saveData()">
            <input type="text" class="event-desc" placeholder="æ”¶æ”¯è¯´æ˜" value="${desc}" style="flex:1" onchange="saveData()">
            <input type="number" class="event-amount" placeholder="é‡‘é¢(+/-)" value="${amt}" style="flex:1" onchange="saveData()">
            <button class="btn-del" onclick="this.parentElement.remove(); saveData()">Ã—</button>
        `;
        safeGetEl('eventContainer').appendChild(div);
    }

    function simulate(p) {
        let balance = p.pv;
        let labels = ['Start'];
        let dataNominal = [p.pv];
        let dataReal = [p.pv];
        
        let curInc = p.income, curExp = p.expense;
        let curNet = p.initNetPmt !== undefined ? p.initNetPmt : (curInc - curExp);

        for (let y = 1; y <= p.years; y++) {
            for (let m = 1; m <= 12; m++) {
                balance = balance * (1 + p.rate/12) + curNet;
            }
            if (p.usePro && p.events[y]) balance += p.events[y];
            if (p.usePro) {
                if (p.isSimplePmtMode) curNet = curNet * (1 + p.incGrowth);
                else {
                    curInc = curInc * (1 + p.incGrowth);
                    curExp = curExp * (1 + p.expGrowth);
                    curNet = curInc - curExp;
                }
            }
            let realValue = balance / Math.pow(1 + currentCPI/100, y);
            labels.push(y + 'å¹´');
            dataNominal.push(balance);
            dataReal.push(realValue);
        }
        return { finalBalance: balance, finalReal: dataReal[dataReal.length-1], labels: labels, dataNominal: dataNominal, dataReal: dataReal };
    }

    function runCalculation() {
        try {
            let events = {};
            if (isProMode) {
                document.querySelectorAll('.event-row').forEach(row => {
                    const y = parseInt(row.querySelector('.event-year').value);
                    const amt = parseFloat(row.querySelector('.event-amount').value);
                    if (y && !isNaN(amt)) {
                        if (!events[y]) events[y] = 0;
                        events[y] += amt;
                    }
                });
            }

            const rate = getVal('rate', 'rate') / 100;
            const incGrowth = getVal('inc_growth', 'inc_growth') / 100;
            const expGrowth = getVal('exp_growth', 'exp_growth') / 100;

            lastResult.inputs = {
                pv: getRawVal('pv'), rate: getRawVal('rate'), years: getRawVal('years'),
                pmt_desc: isProMode ? `æ”¶å…¥${getRawVal('income')}/æ”¯å‡º${getRawVal('expense')}` : `æœˆå­˜${getRawVal('simple_pmt')}`
            };

            let res;
            if (currentTab === 'fv') {
                const pv = getVal('pv', 'pv'); const years = getVal('years', 'years');
                let income = 0, expense = 0, initNetPmt = 0;
                if (isProMode) { income = getVal('income', 'income'); expense = getVal('expense', 'expense'); }
                else { initNetPmt = getVal('simple_pmt', 'simple_pmt'); }

                res = simulate({
                    pv, rate, years, income, expense, initNetPmt: isProMode ? undefined : initNetPmt,
                    incGrowth, expGrowth, events, usePro: isProMode
                });
                safeGetEl('target_fv').value = parseInt(res.finalBalance).toLocaleString();
                
            } else if (currentTab === 'pmt') {
                const pv = getVal('pv', 'pv'); const target = getVal('target_fv', 'target_fv'); const years = getVal('years', 'years');
                let low = -10000000, high = 10000000, sol = 0;
                for(let i=0; i<40; i++) {
                    let mid = (low + high) / 2;
                    let r = simulate({ pv, rate, years, initNetPmt: mid, incGrowth, expGrowth, events, usePro: isProMode, isSimplePmtMode: true });
                    if (r.finalBalance < target) low = mid; else high = mid; sol = mid;
                }
                safeGetEl('solved_pmt').value = Math.round(sol).toLocaleString();
                res = simulate({ pv, rate, years, initNetPmt: sol, incGrowth, expGrowth, events, usePro: isProMode, isSimplePmtMode: true });

            } else if (currentTab === 'pv') {
                const target = getVal('target_fv', 'target_fv'); const years = getVal('years', 'years');
                let income = 0, expense = 0, initNetPmt = 0;
                if (isProMode) { income = getVal('income', 'income'); expense = getVal('expense', 'expense'); }
                else { initNetPmt = getVal('simple_pmt', 'simple_pmt'); }
                let low = -100000000, high = 100000000, sol = 0;
                for(let i=0; i<40; i++) {
                    let mid = (low + high) / 2;
                    let r = simulate({ pv: mid, rate, years, income, expense, initNetPmt: isProMode ? undefined : initNetPmt, incGrowth, expGrowth, events, usePro: isProMode });
                    if (r.finalBalance < target) low = mid; else high = mid; sol = mid;
                }
                safeGetEl('pv').value = Math.round(sol).toLocaleString();
                res = simulate({ pv: sol, rate, years, income, expense, initNetPmt: isProMode ? undefined : initNetPmt, incGrowth, expGrowth, events, usePro: isProMode });

            } else if (currentTab === 'years') {
                const pv = getVal('pv', 'pv'); const target = getVal('target_fv', 'target_fv');
                let income = 0, expense = 0, initNetPmt = 0;
                if (isProMode) { income = getVal('income', 'income'); expense = getVal('expense', 'expense'); }
                else { initNetPmt = getVal('simple_pmt', 'simple_pmt'); }
                let y = 0;
                for(y=1; y<=100; y++) {
                    res = simulate({ pv, rate, years: y, income, expense, initNetPmt: isProMode ? undefined : initNetPmt, incGrowth, expGrowth, events, usePro: isProMode });
                    if (res.finalBalance >= target) break;
                }
                safeGetEl('years').value = y;
                // res is already the final result
            }

            if(res) {
                showResult(res.finalBalance, res.finalReal, res.labels, res.dataNominal, res.dataReal, getVal('years','years'), "æœŸæœ«æ€»èµ„äº§");
                updateAchievement(res.finalReal, getVal('years','years'), getVal('pv','pv'));
            }
            saveData();
        } catch(e) {
            console.error("Calculation Error:", e);
            alert("è®¡ç®—å‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥æ•°å€¼");
        }
    }

    function showResult(nominalVal, realVal, labels, dataNominal, dataReal, years, labelText) {
        lastResult.val = nominalVal;
        lastResult.realVal = realVal;
        lastResult.years = years;
        
        safeGetEl('resValue1').innerText = parseInt(nominalVal || 0).toLocaleString();
        safeGetEl('resValue2').innerText = parseInt(realVal || 0).toLocaleString();

        try {
            const ctx = safeGetEl('simChart').getContext('2d');
            if (chartInstance) { chartInstance.destroy(); }
            
            const color = isProMode ? '#8b5cf6' : '#3b82f6';
            const bgColor = isProMode ? 'rgba(139, 92, 246, 0.1)' : 'rgba(59, 130, 246, 0.1)';

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'åä¹‰èµ„äº§ (è´¦é¢)', data: dataNominal,
                            borderColor: color, backgroundColor: bgColor,
                            borderWidth: 3, tension: 0.3, fill: true
                        },
                        {
                            label: 'å®é™…è´­ä¹°åŠ› (æŠ—é€šèƒ€)', data: dataReal,
                            borderColor: '#10b981', borderDash: [5,5],
                            borderWidth: 2, tension: 0.3, pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: true, position:'top', align:'end', labels:{boxWidth:10} } },
                    scales: { 
                        y: { ticks: { callback: function(value) { return (value/10000).toFixed(0) + 'ä¸‡'; } } },
                        x: { grid: { display: false } }
                    }
                }
            });
        } catch(e) { console.error("Chart Error:", e); }
    }

    function updateAchievement(val, years) {
        const box = safeGetEl('achievementBox');
        box.style.display = 'block';
        let title = "", text = "";

        if (val < 0) {
            title = "ğŸ“‰ æ½œåŠ›è›°ä¼æœŸ"; text = "æš‚æ—¶çš„ç°é‡‘æµæ‰¿å‹ä¸ä»£è¡¨ç»ˆå±€ã€‚è¿™æ­£æ˜¯å®¡è§†è´¢åŠ¡ç»“æ„çš„å¥‘æœºï¼Œå»ºè®®ä¼˜åŒ–å¤§é¢æ”¯å‡ºï¼Œä½ æ‹¥æœ‰è§¦åº•åå¼¹çš„æ— é™å¯èƒ½ã€‚";
        } else if (val < 1000000) {
            title = "ğŸŒ± ç§¯å°‘æˆå¤š"; text = "æ¯ä¸€é¢—å‚å¤©å¤§æ ‘éƒ½å§‹äºå¾®æœ«ã€‚ä½ å·²ç»æˆ˜èƒœäº†æ¶ˆè´¹ä¸»ä¹‰ï¼Œæ˜¯é•¿æœŸä¸»ä¹‰çš„è·µè¡Œè€…ã€‚åšæŒä¸‹å»ï¼Œå¤åˆ©æ•ˆåº”ä¼šåœ¨ç¬¬7å¹´å·¦å³çˆ†å‘ã€‚";
        } else if (val < 3000000) {
            title = "âš“ï¸ äººç”Ÿå‹èˆ±çŸ³"; text = "è¿™ç¬”èµ„é‡‘æ˜¯ä½ åº”å¯¹ä¸ç¡®å®šæ€§çš„åº•æ°”ã€‚åœ¨å¤§éƒ¨åˆ†åŸå¸‚å·²è¶³å¤Ÿå®‰å±…ä¹ä¸šï¼Œåœ¨ä¸€çº¿åŸå¸‚ä¹Ÿæ˜¯åšå®çš„èµ·æ­¥ã€‚";
        } else if (val < 5000000) {
            title = "ğŸš€ åŒºåŸŸå°åº·"; text = "ä½ çš„èµ„äº§å·²è¶…è¶Šç»å¤§å¤šæ•°åŒé¾„äººã€‚è¿™ä¸ä»…æ˜¯ä¸€ä¸²æ•°å­—ï¼Œæ›´æ˜¯ä½ ä»å®¹åº”å¯¹ç”Ÿæ´»é£é™©çš„æŠ¤åŸæ²³ã€‚";
        } else if (val < 10000000) {
            title = "ğŸ° åšå®ä¸­äº§"; text = "æ— è®ºèº«å¤„ä½•åœ°ï¼Œä½ éƒ½æ‹¥æœ‰äº†æå¼ºçš„æŠ—é£é™©èƒ½åŠ›ã€‚åœ¨è¿™ä¸ªé‡çº§ï¼Œè¯·æ›´å¤šå…³æ³¨èµ„äº§é…ç½®ï¼Œè®©é’±ä¸ºä½ å·¥ä½œã€‚";
        } else if (val < 20000000) {
            title = "ğŸ’ é»„é‡‘è‡ªç”±"; text = "A8çº§èµ„äº§ï¼åœ¨ä¸€çº¿åŸå¸‚å±äºä¼˜è¶Šé˜¶å±‚ï¼Œåœ¨äºŒä¸‰çº¿åŸå¸‚å·²å®ç°è´¢åŠ¡è‡ªç”±ã€‚è¢«åŠ¨æ”¶å…¥å¯èƒ½å·²è¦†ç›–ç”Ÿæ´»å¼€æ”¯ã€‚";
        } else if (val < 50000000) {
            title = "ğŸŒŸ æˆ˜ç•¥çº§çªç ´"; text = "ä½ å·²æ‹¥æœ‰äº†å¯¹ç”Ÿæ´»çš„â€œæ‹’ç»æƒâ€ã€‚ç°åœ¨çš„é‡ç‚¹ä¸å†æ˜¯ç§¯ç´¯ï¼Œè€Œæ˜¯èµ„äº§ä¿å€¼ä¸å®¶æ—ä¼ æ‰¿ã€‚";
        } else {
            title = "ğŸŒŒ æ˜Ÿè¾°å¤§æµ·"; text = "å°ç›®æ ‡è¾¾æˆï¼åœ¨è¿™ä¸ªé‡çº§ï¼Œé‡‘é’±åªæ˜¯æ•°å­—ã€‚ä½ çš„å†³ç­–å°†å½±å“æ›´å¤šäººçš„å‘½è¿ã€‚";
        }

        safeGetEl('achTitle').innerText = title;
        safeGetEl('achText').innerText = text;
        lastResult.achTitle = title;
        lastResult.achText = text;
    }

    function copyReport() {
        if(!lastResult.val) { alert("è¯·å…ˆç‚¹å‡»ã€å¼€å§‹æ¨æ¼”ã€‘"); return; }
        
        let report = `ã€ğŸ† äººç”Ÿä¼°å€¼æ²™ç›˜æ¨æ¼” - æˆ˜æŠ¥ã€‘\n`;
        report += `------------------------\n`;
        report += `è§£é”æˆå°±ï¼š${lastResult.achTitle}\n`;
        report += `æˆå°±è§£è¯»ï¼š${lastResult.achText}\n`;
        report += `------------------------\n`;
        report += `ğŸ¯ åä¹‰èµ„äº§: ${parseInt(lastResult.val).toLocaleString()} å…ƒ\n`;
        report += `ğŸŸ¢ å®é™…è´­ä¹°åŠ›: ${parseInt(lastResult.realVal).toLocaleString()} å…ƒ\n`;
        report += `â³ å†æ—¶: ${lastResult.years} å¹´\n`;
        report += `ğŸ’° åˆå§‹æœ¬é‡‘: ${lastResult.inputs.pv}\n`;
        report += `ğŸ“ˆ å¹´åŒ–æ”¶ç›Š: ${lastResult.inputs.rate}% (é€šèƒ€: ${currentCPI}%)\n`;
        report += `ğŸ“¥ æŠ•å…¥æ¨¡å¼: ${lastResult.inputs.pmt_desc}\n`;
        if(isProMode) report += `ğŸš€ æ¨¡å¼: Proä¸“å®¶ (å«åŠ¨æ€å¢é•¿/äººç”Ÿå¤§é¢æ”¶æ”¯)\n`;
        report += `\nğŸ”— åœ¨çº¿æ¨æ¼”: https://fire-sandbox.top/\n`;
        report += `(æ•°æ®ç”± Khalidåœ¨è·¯ä¸Š@å°çº¢ä¹¦ æä¾›æ”¯æŒ)\n`;
        report += `è”ç³»é‚®ç®±: ryan.zhang@pku.org.cn`;

        navigator.clipboard.writeText(report).then(() => {
            alert("âœ… è¯¦ç»†æˆ˜æŠ¥å·²å¤åˆ¶ï¼\nå¯ç›´æ¥ç²˜è´´åˆ†äº«ç»™æœ‹å‹ã€‚");
        }).catch(err => {
            const ta = document.createElement("textarea");
            ta.value = report;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            alert("âœ… è¯¦ç»†æˆ˜æŠ¥å·²å¤åˆ¶ï¼");
        });
    }
</script>
</body>
</html>
